<script>
  const $ = (s) => document.querySelector(s);

  async function consultar() {
    const origin = $('#origen').value.trim();
    const destination = $('#destino').value.trim();
    const weight_kg = Number($('#peso').value || 1);
    const length_cm = Number($('#largo').value || 0);
    const width_cm  = Number($('#ancho').value || 0);
    const height_cm = Number($('#alto').value || 0);

    const payload = {
      origin,
      destination,
      parcel: {
        weight_kg,
        length_cm,
        width_cm,
        height_cm,
      },
    };

    const resp = await fetch('/api/rates', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload),
    });

    const data = await resp.json();
    console.log('CLIENT_RESP', data);

    const out = document.getElementById('resultado');
    out.textContent = resp.ok ? JSON.stringify(data, null, 2)
                              : JSON.stringify(data, null, 2);
  }

  document.getElementById('btn').addEventListener('click', consultar);
</script>
